import { loadState, saveState } from "./state.js";

export const PIECES = Array.from({ length: 8 }, (_, index) => {
  const id = index + 1;
  const audioId = String(id).padStart(2, "0");
  return {
    id,
    img: `assets/pieces/p${id}.png`,
    audio: `assets/audio/${audioId}.mp3`,
  };
});

export const FINAL_LETTER_PATH = "assets/final/letter.html";
export const TARGET_DATE = "2025-08-31";

export const SCREENS = [
  {
    id: 0,
    title: "ĞŸÑ€Ğ¾Ğ»Ğ¾Ğ³ â¤ï¸",
    subtitle: "Ğ¯ ÑĞ¿Ñ€ÑÑ‚Ğ°Ğ» Ğ´Ğ»Ñ Ñ‚ĞµĞ±Ñ 8 Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ñ… Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ğ¹.\nĞ¡Ğ¾Ğ±ĞµÑ€Ñ‘ÑˆÑŒ Ğ¸Ñ… Ğ²ÑĞµ?",
    primaryCtaText: "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ¿ÑƒÑ‚ÑŒ",
    primaryCtaTextContinue: "ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ Ğ´Ğ°Ğ»ÑŒÑˆĞµ",
    secondaryCtaText: "ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ğ·Ğ°Ğ½Ğ¾Ğ²Ğ¾",
    type: "prologue",
  },
  {
    id: 1,
    title: "Ğ”ĞµĞ½ÑŒ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ²ÑÑ‘ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ÑÑŒ",
    text: "",
    type: "date",
    gameConfig: {
      leadTitle: "",
      leadText: "",
      leadHint: "",
    },
  },
  {
    id: 2,
    title: "ĞĞ°Ñˆ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¸Ğ¹ Ñ‡Ğ°Ñ‚ ğŸ¤",
    text: "ĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ñ‡ĞµÑÑ‚Ğ½Ğ¾ (Ğ¸ Ğ½ĞµĞ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ³Ñ€Ğ¸Ğ²Ğ¾)",
    type: "chat",
    gameConfig: {
      intro: [
        "Ñ Ñ‚ÑƒÑ‚ Ğ»ĞµĞ¶Ñƒ Ğ¸ Ğ´ÑƒĞ¼Ğ°Ñâ€¦",
        "Ğ¸Ğ½Ñ‚ĞµÑ€ĞµÑĞ½Ñ‹Ğµ Ğ¼Ñ‹ÑĞ»Ğ¸ ĞºÑÑ‚Ğ°Ñ‚Ğ¸ ğŸ˜",
        "Ğ½Ğ¾ Ñ‚ĞµĞ±Ğµ Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ñ€Ğ°ÑÑĞºĞ°Ğ·Ğ°Ñ‚ÑŒ"
      ],
      turns: [
        {
          prompt: "ĞµÑĞ»Ğ¸ Ñ ÑĞºĞ°Ğ¶Ñƒ Ñ‡Ñ‚Ğ¾ Ñ‚Ñ‹ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ ĞºÑ€Ğ°ÑĞ¸Ğ²Ğ°Ñ",
          options: [
            {
              text: "Ğ¾Ñ‚ ÑƒĞ·Ğµâ€¦ ğŸ˜³",
              reply: "Ñ‚Ñ‹ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ğ¼Ğ¸Ğ»Ğ°Ñ ĞºĞ¾Ğ³Ğ´Ğ° ÑĞ¼ÑƒÑ‰Ğ°ĞµÑˆÑŒÑÑ"
            },
            {
              text: "Ğ½Ñƒ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ÑÑŒ Ğ°Ñ…Ğ°Ñ…Ğ°",
              reply: "Ñ ĞµÑ‰Ñ‘ Ğ´Ğ°Ğ¶Ğµ Ğ½Ğµ Ñ€Ğ°Ğ·Ğ¾Ğ³Ñ€ĞµĞ»ÑÑ ğŸ˜"
            },
            {
              text: "Ñ Ğ²ÑĞµĞ³Ğ´Ğ° Ñ‚Ğ°ĞºĞ°Ñ Ğ²Ğ¾Ğ¾Ğ±Ñ‰Ğµ-Ñ‚Ğ¾",
              reply: "Ñ ÑÑ‚Ğ¸Ğ¼ ÑĞ¿Ğ¾Ñ€Ğ¸Ñ‚ÑŒ Ğ½Ğµ Ğ±ÑƒĞ´Ñƒ)"
            }
          ]
        },
        {
          prompt: "Ñ ÑĞµĞ³Ğ¾Ğ´Ğ½Ñ Ñ‚Ğ°Ğº Ñ€Ğ°Ğ½Ğ¾ Ğ²ÑÑ‚Ğ°Ğ»â€¦",
          options: [
            {
              text: "Ñ Ğ¿Ğ¾Ğ½ÑĞ»Ğ° Ğº Ñ‡ĞµĞ¼Ñƒ Ñ‚Ñ‹ Ğ°Ñ…Ğ°Ñ…Ğ°",
              reply: "Ñ Ğ²Ğ¾Ğ¾Ğ±Ñ‰Ğµ-Ñ‚Ğ¾ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ¿Ñ€Ğ¾ Ñ€ĞµĞ¶Ğ¸Ğ¼ ÑĞ½Ğ° (Ğ¸Ğ»Ğ¸ Ğ½ĞµÑ‚)"
            },
            {
              text: "Ğ¸ Ğ½Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ñ‚Ñ‹? ğŸ˜",
              reply: "Ğ¾Ñ‚ ÑƒĞ¶Ğµ, Ğ¼Ñ‹ Ğ¿Ğ¾Ğ½Ğ¸Ğ¼Ğ°ĞµĞ¼ Ğ´Ñ€ÑƒĞ³ Ğ´Ñ€ÑƒĞ³Ğ° Ğ±ĞµĞ· ÑĞ»Ğ¾Ğ²)"
            },
            {
              text: "Ñ„Ñƒ ĞºĞ°ĞºĞ¾Ğ¹",
              reply: "Ñ Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ğ» Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ğ¼ Ğ°Ñ…Ğ°Ñ…Ğ°"
            }
          ]
        },
        {
          prompt: "Ğ¼Ğ½Ğµ Ğ¿Ñ€Ğ°Ğ²Ğ´Ğ° Ğ½Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ Ñ‚ĞµĞ±Ñ ÑĞ»ÑƒÑˆĞ°Ñ‚ÑŒ",
          options: [
            {
              text: "Ğ¿Ğ»Ğ°Ğ²Ğ´Ğ°? ğŸ¥º",
              reply: "Ğ¿Ğ»Ğ°Ğ²Ğ´Ğ°. Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ ĞºĞ¾Ğ³Ğ´Ğ° Ñ‚Ñ‹ ÑƒĞ²Ğ»ĞµĞºĞ°ĞµÑˆÑŒÑÑ Ğ¸ Ğ·Ğ°Ğ±Ñ‹Ğ²Ğ°ĞµÑˆÑŒ Ğ²ÑÑ‘ Ğ²Ğ¾ĞºÑ€ÑƒĞ³"
            },
            {
              text: "Ñ Ğ¶Ğµ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ±Ğ¾Ğ»Ñ‚Ğ°Ñ Ğ°Ñ…Ğ°Ñ…Ğ°",
              reply: "Ğ¸ Ñ Ğ¾Ğ±Ğ¾Ğ¶Ğ°Ñ ĞºĞ°Ğ¶Ğ´ÑƒÑ Ğ¼Ğ¸Ğ½ÑƒÑ‚Ñƒ"
            },
            {
              text: "Ñ‚Ğ¾Ğ³Ğ´Ğ° Ñ Ñ‰Ğ°Ñ Ñ€Ğ°ÑÑĞºĞ°Ğ¶Ñƒ Ğ¸ÑÑ‚Ğ¾Ñ€Ğ¸Ñ Ğ½Ğ° Ñ‡Ğ°Ñ",
              reply: "Ñ ÑƒĞ¶Ğµ ÑƒĞ´Ğ¾Ğ±Ğ½Ğ¾ ÑƒÑÑ‚Ñ€Ğ¾Ğ¸Ğ»ÑÑ. Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°Ğ¹"
            }
          ]
        },
        {
          prompt: "Ğ¼Ğ½Ğµ Ğ½Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ ĞºĞ°Ğº Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ²Ñ‹ÑĞºĞ°Ğ·Ğ°Ñ‚ÑŒ Ğ²ÑÑ‘ Ğ¿Ñ€ÑĞ¼Ğ¾",
          options: [
            {
              text: "Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ñ Ñ‡Ñ‚Ğ¾ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑ",
              reply: "Ğ¸ ÑÑ‚Ğ¾ Ğ² Ñ‚ĞµĞ±Ğµ ÑĞ°Ğ¼Ğ¾Ğµ Ğ½Ğ°ÑÑ‚Ğ¾ÑÑ‰ĞµĞµ, Ñ Ñ‚Ğ°Ğº Ğ½Ğµ Ğ²ÑĞµĞ³Ğ´Ğ° ÑƒĞ¼ĞµÑ"
            },
            {
              text: "Ñ Ğ¸Ğ½Ğ¾Ğ³Ğ´Ğ° ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ Ñ€ĞµĞ·ĞºĞ¾ Ğ²Ñ‹ÑĞºĞ°Ğ·Ñ‹Ğ²Ğ°ÑÑÑŒ",
              reply: "Ğ·Ğ°Ñ‚Ğ¾ Ñ‡ĞµÑÑ‚Ğ½Ğ¾, Ñ Ğ´Ğ°Ğ¶Ğµ Ğ½ĞµĞ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ·Ğ°Ğ²Ğ¸Ğ´ÑƒÑ ÑÑ‚Ğ¾Ğ¹ ÑĞ¼ĞµĞ»Ğ¾ÑÑ‚Ğ¸"
            },
            {
              text: "Ñ Ğ¸Ğ¼Ğ¿ÑƒĞ»ÑŒÑĞ¸Ğ²Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ğ°Ñ…Ğ°Ñ…Ğ°",
              reply: "Ğ¸ ÑÑ‚Ğ¾ Ğ¿Ñ€ĞµĞºÑ€Ğ°ÑĞ½Ğ¾, Ñ€ÑĞ´Ğ¾Ğ¼ Ñ Ñ‚Ğ¾Ğ±Ğ¾Ğ¹ Ñ ÑƒÑ‡ÑƒÑÑŒ Ğ±Ñ‹Ñ‚ÑŒ ÑĞ¼ĞµĞ»ĞµĞµ"
            }
          ]
        },
        {
          prompt: "Ğ¼Ğ½Ğµ Ğ½Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ ĞºĞ°ĞºĞ¸Ğ¼ Ñ ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ÑÑÑŒ Ñ€ÑĞ´Ğ¾Ğ¼ Ñ Ñ‚Ğ¾Ğ±Ğ¾Ğ¹",
          options: [
            {
              text: "ĞºĞ°ĞºĞ¸Ğ¼?",
              reply: "ÑĞ¿Ğ¾ĞºĞ¾Ğ¹Ğ½Ñ‹Ğ¼ Ğ¸ Ğ¾Ñ‚ĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¼. Ñ Ğ¼Ğ¾Ğ³Ñƒ Ğ±Ñ‹Ñ‚ÑŒ ÑĞ¾Ğ±Ğ¾Ğ¹ Ğ¸ Ğ½Ğµ Ğ±Ğ¾ÑÑ‚ÑŒÑÑ Ğ¿Ğ¾ĞºĞ°Ğ·Ğ°Ñ‚ÑŒÑÑ ÑÑ‚Ñ€Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ğ¸Ğ»Ğ¸ ÑĞ»Ğ¸ÑˆĞºĞ¾Ğ¼ ÑĞ¼Ğ¾Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼"
            },
            {
              text: "Ğ¿Ğ»Ğ°Ğ²Ğ´Ğ°?",
              reply: "Ğ¿Ğ»Ğ°Ğ²Ğ´Ğ°, Ñ Ğ´Ğ°Ğ¶Ğµ Ğ½Ğµ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ», Ñ‡Ñ‚Ğ¾ ÑĞ¼Ğ¾Ğ³Ñƒ Ñ‚Ğ°Ğº Ñ€Ğ°ÑÑĞ»Ğ°Ğ±Ğ¸Ñ‚ÑŒÑÑ Ñ€ÑĞ´Ğ¾Ğ¼ Ñ ĞºĞµĞ¼-Ñ‚Ğ¾"
            },
            {
              text: "Ğ°Ñ…Ğ°Ñ…Ğ° Ğ·Ğ²ÑƒÑ‡Ğ¸Ñ‚ ÑĞµÑ€ÑŒÑ‘Ğ·Ğ½Ğ¾",
              reply: "Ğ½Ñƒ Ñ Ğ¸Ğ½Ğ¾Ğ³Ğ´Ğ° Ğ¼Ğ¾Ğ³Ñƒ"
            }
          ]
        }
      ],
      successTitle: "Ğ¿ĞµÑ€ĞµĞ¿Ğ¸ÑĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ° ğŸ’",
      successText: "Ğ¼Ğ½Ğµ Ğ½Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑÑ, Ñ‡Ñ‚Ğ¾ Ğ¼Ñ‹ Ğ¼Ğ¾Ğ¶ĞµĞ¼ Ğ±Ñ‹Ñ‚ÑŒ Ñ‚Ğ°ĞºĞ¸Ğ¼Ğ¸ Ğ¸ÑĞºÑ€ĞµĞ½Ğ½Ğ¸Ğ¼Ğ¸ Ğ´Ñ€ÑƒĞ³ Ñ Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼. ÑĞ¿Ğ°ÑĞ¸Ğ±Ğ¾ Ñ‚ĞµĞ±Ğµ Ğ·Ğ° ÑÑ‚Ğ¾",
    }
  },
  {
    id: 3,
    title: "ĞĞ°Ğ¹Ğ´Ğ¸ ÑĞµÑ€Ğ´ĞµÑ‡ĞºĞ¾",
    text: "Ğ˜Ñ‰Ğ¸ ÑĞµÑ€Ğ´ĞµÑ‡ĞºĞ¾. Ğ¯ Ğ¿Ğ¾Ğ´ÑĞºĞ°Ğ¶Ñƒ, Ğ½Ğ°ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ñ‚Ñ‹ Ğ±Ğ»Ğ¸Ğ·ĞºĞ¾.",
    type: "heart",
    gameConfig: {
      correctIndex: 6,
      maxAttempts: 6,
    },
  },
  {
    id: 4,
    title: "Ğ¡Ğ¾Ğ±ĞµÑ€Ğ¸ ÑĞµÑ€Ğ´Ñ†Ğµ",
    text: "Ğ¡Ğ¾Ğ±ĞµÑ€Ğ¸ Ğ¿Ğ°Ğ·Ğ» Ğ¸Ğ· ĞºÑƒÑĞ¾Ñ‡ĞºĞ¾Ğ².",
    type: "puzzle-heart",
    gameConfig: {
      gridSize: 3,
      snapTolerance: 28,
      finalText: "Ğ’Ğ¾Ñ‚ Ñ‚Ğ°Ğº Ñ‚Ñ‹ ÑĞ¾Ğ±Ñ€Ğ°Ğ»Ğ° Ğ¼Ğ¾Ñ‘ ÑĞµÑ€Ğ´Ñ†Ğµ, ĞºĞ¾Ğ³Ğ´Ğ° Ğ¼Ñ‹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¸ Ğ¾Ğ±Ñ‰Ğ°Ñ‚ÑŒÑÑ.",
    },
  },
  {
    id: 5,
    title: "Ğ’Ñ‹Ğ±Ğ¾Ñ€-ÑÑ†ĞµĞ½Ğ°",
    text: "Ğ§Ñ‚Ğ¾ Ñ‚Ñ‹ Ğ²Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑˆÑŒ Ğ² ÑÑ‚Ğ¾Ñ‚ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚?",
    type: "choice",
    gameConfig: {
      options: ["ĞĞ±Ğ½ÑÑ‚ÑŒ", "Ğ¡Ğ¼ĞµÑÑ‚ÑŒÑÑ", "Ğ¢Ğ¸Ñ…Ğ¾ Ñ€ÑĞ´Ğ¾Ğ¼"],
    },
  },
  {
    id: 6,
    title: "ĞÑ‚ĞºÑ€Ğ¾Ğ¹ Ñ„Ğ¾Ñ‚Ğ¾ Ğ¿Ğ»Ğ¸Ñ‚ĞºĞ°Ğ¼Ğ¸",
    text: "Ğ¡Ğ½Ğ¸Ğ¼Ğ¸ Ğ²ÑĞµ Ğ¿Ğ»Ğ¸Ñ‚ĞºĞ¸, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ Ñ„Ğ¾Ñ‚Ğ¾.",
    type: "tiles",
    gameConfig: {
      image: "assets/img/photo.jpg",
      tiles: 9,
    },
  },
  {
    id: 7,
    title: "Ğ¡Ñ‚Ñ€ĞµĞ»ĞºĞ¸-Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ",
    text: "ĞŸĞ¾Ğ²Ñ‚Ğ¾Ñ€Ğ¸ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ ÑÑ‚Ñ€ĞµĞ»Ğ¾Ğº.",
    type: "arrows",
    gameConfig: {
      sequence: ["â†’", "â†’", "â†“", "â†"],
    },
  },
  {
    id: 8,
    title: "Ğ¤Ğ¸Ğ½Ğ°Ğ»-Ğ¿Ğ°Ğ·Ğ»",
    text: "Ğ¡Ğ¾Ğ±ĞµÑ€Ğ¸ Ğ¿Ğ¸ÑÑŒĞ¼Ğ¾ Ğ¸Ğ· ĞºÑƒÑĞ¾Ñ‡ĞºĞ¾Ğ².",
    type: "puzzle",
  },
];

export function unlockPiece(pieceId) {
  const state = loadState();
  const alreadyUnlocked = state.unlockedPieces.includes(pieceId);
  if (!alreadyUnlocked) {
    state.unlockedPieces = [...state.unlockedPieces, pieceId].sort((a, b) => a - b);
    saveState(state);
  }
  return state;
}
